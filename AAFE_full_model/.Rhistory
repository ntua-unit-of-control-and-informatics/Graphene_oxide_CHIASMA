PVLIn <- 1.09e-2 #Brown et al. 1997, Table 4
VLIn <- PVLIn * BW #Large intestine volume kg=L
admin.dose_per_kg <- 50 # administered dose in mg PFOA/kg BW
admin.dose <- admin.dose_per_kg*BW*1e03 #ug PFOA
admin.time <- 0 # time when doses are administered, in mins
admin.type <- "ip"
sex <- "F"
user_input <- list('BW'=BW,
"admin.dose"= admin.dose,
"np_size"=np_size,
"admin.time" = admin.time,
"admin.type" = admin.type,
"estimated_params" = estimated_params,
"sex" = sex)
params <- create.params(user_input)
inits <- create.inits(params)
events <- create.events(params)
# sample_time: a vector of time points to solve the ODEs
sample_time=seq(0,10080,40) #min
# ode(): The solver of the ODEs
solution <- data.frame(deSolve::ode(times = sample_time,  func = ode.func,
y = inits, parms = params,
events = events,
method="lsodes",rtol = 1e-05, atol = 1e-05))
# We need to keep only the predictions for the relevant compartments for the time points
# at which we have available data.
#======================================df20=========================================================
exp_data <- dataset$df20 # retrieve data of  Yang (2010) 50 mg/kg tissues RGO
colnames(exp_data)[c(2,3)] <- c("time", "mass")
preds_Yang_IP_tissues_RGO <- solution[, c("time","Mliver","Mspleen", "Mkidneys", "Mheart","Mlungs",
"Mstomach","Mintestine","Mbrain")]
#======================================df21=========================================================
admin.dose_per_kg <- 100 # administered dose in mg PFOA/kg BW
admin.dose <- admin.dose_per_kg*BW*1e03 #ug PFOA
admin.time <- 0 # time when doses are administered, in mins
admin.type <- "oral"
sex <- "F"
user_input <- list('BW'=BW,
"admin.dose"= admin.dose,
"np_size"=np_size,
"admin.time" = admin.time,
"admin.type" = admin.type,
"estimated_params" = estimated_params,
"sex" = sex)
params <- create.params(user_input)
inits <- create.inits(params)
events <- create.events(params)
# sample_time: a vector of time points to solve the ODEs
sample_time=seq(0,1440,5) #min
# ode(): The solver of the ODEs
solution <- data.frame(deSolve::ode(times = sample_time,  func = ode.func,
y = inits, parms = params,
events = events,
method="lsodes",rtol = 1e-05, atol = 1e-05))
# We need to keep only the predictions for the relevant compartments for the time points
# at which we have available data.
#======================================df21=========================================================
exp_data <- dataset$df21 # retrieve data of  Yang (2010) 100 mg/kg tissues RGO
colnames(exp_data)[c(2,3)] <- c("time", "mass")
preds_Yang_OR_tissues_RGO <- solution[, c("time","Mliver","Mspleen", "Mkidneys", "Mheart","Mlungs",
"Mstomach","Mintestine","Mbrain")]
# Set up simulations for the 22nd case, i.e. Yang (2013) 50 mg/kg tissues nanoGO
BW <- 0.023  # body weight (kg) #mean value of the BW in figure S6
PVLi <- 5.49e-2 #Brown et al. 1997, Table 4
VLi <- PVLi * BW #liver volume kg=L
PVSpl <- 3.5e-3 #Brown et al. 1997, Table 4
VSpl <- PVSpl * BW #Spleen volume kg=L
V_macro_Spl = 6.94/100*VSpl #https://doi.org/10.1038/s41374-018-0137-1
PVKi <- 1.67e-2 #Brown et al. 1997, Table 4
VKi <- PVKi * BW #kidney volume kg=L
PVH <- 5e-3 #Brown et al. 1997, Table 4
VH <- PVH * BW #Heart volume kg=L
PVLn <- 7.3e-3 #Brown et al. 1997, Table 4
VLn <- PVLn * BW #Lung volume kg=L
V_macro_Ln <- 7.5/100 * VLn #random
PVBr <- 1.65e-2 #Brown et al. 1997, Table 4
VBr <- PVBr * BW #Brain volume kg=L
PVSt <- 6e-3 #Brown et al. 1997, Table 4
VSt <- PVSt * BW #Stomach volume kg=L
PVSIn <- 2.53e-2 #Brown et al. 1997, Table 4
VSIn <- PVSIn * BW #Small intestine volume kg=L
PVLIn <- 1.09e-2 #Brown et al. 1997, Table 4
VLIn <- PVLIn * BW #Large intestine volume kg=L
admin.dose_per_kg <- 50 # administered dose in mg PFOA/kg BW
admin.dose <- admin.dose_per_kg*BW*1e03 #ug PFOA
admin.time <- 0 # time when doses are administered, in mins
admin.type <- "ip"
sex <- "F"
user_input <- list('BW'=BW,
"admin.dose"= admin.dose,
"admin.time" = admin.time,
"admin.type" = admin.type,
"estimated_params" = estimated_params,
"sex" = sex)
params <- create.params(user_input)
inits <- create.inits(params)
events <- create.events(params)
# sample_time: a vector of time points to solve the ODEs
sample_time=seq(0,10080,40) #min
# ode(): The solver of the ODEs
solution <- data.frame(deSolve::ode(times = sample_time,  func = ode.func,
y = inits, parms = params,
events = events,
method="lsodes",rtol = 1e-05, atol = 1e-05))
# We need to keep only the predictions for the relevant compartments for the time points
# at which we have available data.
#======================================df22=========================================================
exp_data <- dataset$df22 # retrieve data of  Yang (2010) 50 mg/kg tissues nanoG ip
colnames(exp_data)[c(2,3)] <- c("time", "mass")
preds_Yang_IP_tissues_nRGO <- solution[, c("time","Mliver","Mspleen", "Mkidneys", "Mheart","Mlungs",
"Mstomach","Mintestine","Mbrain")]
#======================================df23=========================================================
admin.dose_per_kg <- 100 # administered dose in mg PFOA/kg BW
admin.dose <- admin.dose_per_kg*BW*1e03 #ug PFOA
admin.time <- 0 # time when doses are administered, in mins
admin.type <- "oral"
sex <- "F"
user_input <- list('BW'=BW,
"admin.dose"= admin.dose,
"admin.time" = admin.time,
"admin.type" = admin.type,
"estimated_params" = estimated_params,
"sex" = sex)
params <- create.params(user_input)
inits <- create.inits(params)
events <- create.events(params)
# sample_time: a vector of time points to solve the ODEs
sample_time=seq(0,1440,5) #min
# ode(): The solver of the ODEs
solution <- data.frame(deSolve::ode(times = sample_time,  func = ode.func,
y = inits, parms = params,
events = events,
method="lsodes",rtol = 1e-05, atol = 1e-05))
# We need to keep only the predictions for the relevant compartments for the time points
# at which we have available data.
#======================================df23=========================================================
exp_data <- dataset$df23 # retrieve data of  Yang (2013) 50 mg/kg tissues nanoG oral
colnames(exp_data)[c(2,3)] <- c("time", "mass")
preds_Yang_OR_tissues_nRGO <- solution[, c("time","Mliver","Mspleen", "Mkidneys", "Mheart","Mlungs",
"Mstomach","Mintestine","Mbrain")]
# ######################################################################################
#Plot the predictions against the observations
library(ggplot2)
# Function that creates a plot given a compartment name and the respective predictions and observations
create.plots <- function(predictions, observations, compartment){
#Colours of observations and predictions
cls <-  c("predictions" = "#56B4E9",  "Observations" = "#D55E00")
ggplot(data = predictions)+
geom_line( aes_string(x= "Time", y= rlang::expr(!!compartment),
color = '"predictions"'),  size=1.5,alpha = 0.7) +
geom_point(data=observations, aes_string(x="Time", y= rlang::expr(!!compartment),
color='"Observations"'), size=4)+
labs(title = rlang::expr(!!compartment),
y = expression("GO mass (" * mu* "g)" ),
x = "Time (min)")+
theme(plot.title = element_text(hjust = 0.5))+
scale_color_manual("", values=cls,
guide = guide_legend(override.aes =
list(shape = c(16,NA),
linetype = c(0,1))))+
theme_light() +
theme(legend.position=c(1,1),
legend.justification=c(0, 1),
legend.key.size = unit(1.5, 'cm'),
legend.title = element_text(size=14),
axis.title=element_text(size=14),
legend.text = element_text(size=14)
)
}
# Convert Liu 2012, male small_1_tissues from long to wide format using reshape
experiment1 <- reshape(Liu_1_small_tissues[c("Tissue" ,"Time_min",
"%ID")],
idvar = "Time_min", timevar = "Tissue", direction = "wide")
colnames(experiment1) <- c("Time",Liu_1_small_tissues$Tissue )
experiment1$Heart <- experiment1$Heart *admin.dose/100
experiment1$Liver <- experiment1$Liver *admin.dose/100
experiment1$Spleen <- experiment1$Spleen*admin.dose/100
experiment1$Stomach <- experiment1$Stomach*admin.dose/100
experiment1$Kidneys <- experiment1$Kidneys*admin.dose/100
experiment1$Lungs <- experiment1$Lungs*admin.dose/100
experiment1$Brain <- experiment1$Brain*admin.dose/100
experiment1$Small_intestine <- experiment1$Small_intestine*admin.dose/100
experiment1$Large_intestine <- experiment1$Large_intestine*admin.dose/100
# Convert Liu 2012, male small_1_tissues_dif_times from long to wide format using reshape
experiment2 <- reshape(Liu_1_small_diftp_tissues[c("Tissue" ,"Time_min",
"%ID")],
idvar = "Time_min", timevar = "Tissue", direction = "wide")
colnames(experiment2) <- c("Time",unique(Liu_1_small_diftp_tissues$Tissue))
experiment2$Heart <- experiment2$Heart *admin.dose/100
experiment2$Liver <- experiment2$Liver *admin.dose/100
experiment2$Spleen <- experiment2$Spleen*admin.dose/100
experiment2$Stomach <- experiment2$Stomach*admin.dose/100
experiment2$Kidneys <- experiment2$Kidneys*admin.dose/100
experiment2$Lungs <- experiment2$Lungs*admin.dose/100
experiment2$Brain <- experiment2$Brain*admin.dose/100
experiment2$Small_intestine <- experiment2$Small_intestine*admin.dose/100
experiment2$Large_intestine <- experiment2$Large_intestine*admin.dose/100
# Convert Liu 2012, male large_1_tissues_dif_times from long to wide format using reshape
experiment3 <- reshape(Liu_1_large_diftp_tissues[c("Tissue" ,"Time_min",
"%ID")],
idvar = "Time_min", timevar = "Tissue", direction = "wide")
colnames(experiment3) <- c("Time",unique(Liu_1_large_diftp_tissues$Tissue))
experiment3$Heart <- experiment3$Heart *admin.dose/100
experiment3$Liver <- experiment3$Liver *admin.dose/100
experiment3$Spleen <- experiment3$Spleen*admin.dose/100
experiment3$Stomach <- experiment3$Stomach*admin.dose/100
experiment3$Kidneys <- experiment3$Kidneys*admin.dose/100
experiment3$Lungs <- experiment3$Lungs*admin.dose/100
experiment3$Brain <- experiment3$Brain*admin.dose/100
experiment3$Small_intestine <- experiment3$Small_intestine*admin.dose/100
experiment3$Large_intestine <- experiment3$Large_intestine*admin.dose/100
# Convert Liu 2012, male small_2_tissues from long to wide format using reshape
experiment4 <- reshape(Liu_2_small_tissues[c("Tissue" ,"Time_min",
"%ID")],
idvar = "Time_min", timevar = "Tissue", direction = "wide")
colnames(experiment4) <- c("Time",Liu_2_small_tissues$Tissue)
experiment4$Heart <- experiment4$Heart *admin.dose/100
experiment4$Liver <- experiment4$Liver *admin.dose/100
experiment4$Spleen <- experiment4$Spleen*admin.dose/100
experiment4$Stomach <- experiment4$Stomach*admin.dose/100
experiment4$Kidneys <- experiment4$Kidneys*admin.dose/100
experiment4$Lungs <- experiment4$Lungs*admin.dose/100
experiment4$Brain <- experiment4$Brain*admin.dose/100
experiment4$Small_intestine <- experiment4$Small_intestine*admin.dose/100
experiment4$Large_intestine <- experiment4$Large_intestine*admin.dose/100
# Convert Liu 2012, male small_10_tissues from long to wide format using reshape
experiment5 <- reshape(Liu_10_small_tissues[c("Tissue" ,"Time_min",
"%ID")],
idvar = "Time_min", timevar = "Tissue", direction = "wide")
colnames(experiment5) <- c("Time",Liu_10_small_tissues$Tissue)
experiment5$Heart <- experiment5$Heart *admin.dose/100
experiment5$Liver <- experiment5$Liver *admin.dose/100
experiment5$Spleen <- experiment5$Spleen*admin.dose/100
experiment5$Stomach <- experiment5$Stomach*admin.dose/100
experiment5$Kidneys <- experiment5$Kidneys*admin.dose/100
experiment5$Lungs <- experiment5$Lungs*admin.dose/100
experiment5$Brain <- experiment5$Brain*admin.dose/100
experiment5$Small_intestine <- experiment5$Small_intestine*admin.dose/100
experiment5$Large_intestine <- experiment5$Large_intestine*admin.dose/100
# Convert Liu 2012, male small_1_blood_dif_times from long to wide format using reshape
experiment6 <- reshape(Liu_1_small_diftp_blood[c("Tissue" ,"Time_min",
"%ID")],
idvar = "Time_min", timevar = "Tissue", direction = "wide")
colnames(experiment6) <- c("Time",unique(Liu_1_small_diftp_blood$Tissue))
experiment6$Blood <- experiment6$Blood*admin.dose/100
# Convert Liu 2012, male large_1_blood_dif_times from long to wide format using reshape
experiment7 <- reshape(Liu_1_large_diftp_blood[c("Tissue" ,"Time_min",
"%ID")],
idvar = "Time_min", timevar = "Tissue", direction = "wide")
colnames(experiment7) <- c("Time",unique(Liu_1_large_diftp_blood$Tissue))
experiment7$Blood <- experiment7$Blood*admin.dose/100
# Convert Li 2013, male nanoGO_tissues_diff_time_points from long to wide format using reshape
experiment8 <- reshape(Li_IN_tissues[c("Tissue" ,"Time_min",
"%ID")],
idvar = "Time_min", timevar = "Tissue", direction = "wide")
colnames(experiment8) <- c("Time",unique(Li_IN_tissues$Tissue))
experiment8$Blood<- experiment8$Blood *admin.dose/100
experiment8$Heart <- experiment8$Heart *admin.dose/100
experiment8$Lungs <- experiment8$Lungs  *admin.dose/100
experiment8$Liver <- experiment8$Liver *admin.dose/100
experiment8$Spleen <- experiment8$Spleen*admin.dose/100
experiment8$Kidney <- experiment8$Kidney *admin.dose/100
experiment8$Stomach <- experiment8$Stomach*admin.dose/100
experiment8$Small_intestine <- experiment8$Small_intestine*admin.dose/100
experiment8$Large_intestine <- experiment8$Large_intestine*admin.dose/100
# Convert Li 2014, male nanoGO_tissues_diff_time_points from long to wide format using reshape
experiment9 <- reshape(Li_IV_tissues[c("Tissue" ,"Time_min",
"%ID")],
idvar = "Time_min", timevar = "Tissue", direction = "wide")
colnames(experiment9) <- c("Time",unique(Li_IV_tissues$Tissue))
experiment9$Blood<- experiment9$Blood *admin.dose/100
experiment9$Heart <- experiment9$Heart *admin.dose/100
experiment9$Lungs <- experiment9$Lungs  *admin.dose/100
experiment9$Liver <- experiment9$Liver *admin.dose/100
experiment9$Spleen <- experiment9$Spleen*admin.dose/100
experiment9$Kidney <- experiment9$Kidney *admin.dose/100
experiment9$Stomach <- experiment9$Stomach*admin.dose/100
experiment9$Small_intestine <- experiment9$Small_intestine*admin.dose/100
experiment9$Large_intestine <- experiment9$Large_intestine*admin.dose/100
# Convert Li 2014, male nanoGO_blood_diff_time_points from long to wide format using reshape
experiment10 <- reshape(Li_IV_blood[c("Tissue" ,"Time_min",
"%ID/gtissue")],
idvar = "Time_min", timevar = "Tissue", direction = "wide")
colnames(experiment10) <- c("Time",unique(Li_IV_blood$Tissue))
experiment10$Blood<- experiment10$Blood *admin.dose*VB*1000/100
# Convert Li 2014, male nanoGO_PEG_tissues_diff_time_points from long to wide format using reshape
experiment11 <- reshape(Li_IV_tissues_PEG[c("Tissue" ,"Time_min",
"%ID")],
idvar = "Time_min", timevar = "Tissue", direction = "wide")
colnames(experiment11) <- c("Time",unique(Li_IV_tissues_PEG$Tissue))
experiment11$Lungs <- experiment11$Lungs  *admin.dose/100
experiment11$Liver <- experiment11$Liver *admin.dose/100
experiment11$Spleen <- experiment11$Spleen*admin.dose/100
# Convert Li 2014, male nanoGO_PEG_blood_diff_time_points from long to wide format using reshape
experiment12 <- reshape(Li_IV_blood_PEG[c("Tissue" ,"Time_min",
"%ID/gtissue")],
idvar = "Time_min", timevar = "Tissue", direction = "wide")
colnames(experiment12) <- c("Time",unique(Li_IV_blood_PEG$Tissue))
experiment12$Blood<- experiment12$Blood *admin.dose*VB*1000/100
# Convert Mao 2016, male nanoGO_tissues_diff_time_points from long to wide format using reshape
experiment13 <- reshape(Mao_IN_tissues[c("Tissue" ,"Time_min",
"%ID")],
idvar = "Time_min", timevar = "Tissue", direction = "wide")
colnames(experiment13) <- c("Time",unique(Mao_IN_tissues$Tissue))
experiment13$Liver <- experiment13$Liver *admin.dose/100
experiment13$Spleen <- experiment13$Spleen*admin.dose/100
experiment13$Stomach <- experiment13$Stomach*admin.dose/100
experiment13$Small_intestine <- experiment13$Small_intestine*admin.dose/100
experiment13$Large_intestine <- experiment13$Large_intestine*admin.dose/100
experiment13$Lungs <- experiment13$Lungs*admin.dose/100
experiment13$Feces <- experiment13$Feces*admin.dose/100
# Convert Mao 2016, male nanoGO_tissues from long to wide format using reshape
experiment14 <- reshape(Mao_OR_tissues[c("Tissue" ,"Time_min",
"%ID")],
idvar = "Time_min", timevar = "Tissue", direction = "wide")
colnames(experiment14) <- c("Time",unique(Mao_OR_tissues$Tissue))
experiment14$Stomach <- experiment14$Stomach*admin.dose/100
experiment14$Small_intestine <- experiment14$Small_intestine*admin.dose/100
experiment14$Large_intestine <- experiment14$Large_intestine*admin.dose/100
experiment14$Feces <- experiment14$Feces*admin.dose/100
# Convert Yang 2010, male nanographene sheets_tissues from long to wide format using reshape
experiment15 <- reshape(Yang_IV_blood[c("Tissue" ,"Time_min",
"%ID/gtissue")],
idvar = "Time_min", timevar = "Tissue", direction = "wide")
colnames(experiment15) <- c("Time",unique(Yang_IV_blood$Tissue))
experiment15$Blood <- experiment15$Blood *admin.dose*VB*1000/100
# Convert Yang 2010, male nanographene sheets_tissues from long to wide format using reshape
experiment16 <- reshape(Yang_IV_LiSpl[c("Tissue" ,"Time_min",
"%ID/gtissue")],
idvar = "Time_min", timevar = "Tissue", direction = "wide")
colnames(experiment16) <- c("Time",unique(Yang_IV_LiSpl$Tissue))
experiment16$Liver <- experiment16$Liver*admin.dose*VLi*1000/100
experiment16$Spleen <- experiment16$Spleen*admin.dose*VSpl*1000/100
# Convert Yang 2010, male nanographene sheets_tissues from long to wide format using reshape
experiment17 <- reshape(Yang_IV_tissues[c("Tissue" ,"Time_min",
"%ID/gtissue")],
idvar = "Time_min", timevar = "Tissue", direction = "wide")
colnames(experiment17) <- c("Time",unique(Yang_IV_tissues$Tissue))
experiment17$Liver <- experiment17$Liver *admin.dose*VLi*1000/100
experiment17$Spleen <- experiment17$Spleen*admin.dose*VSpl*1000/100
experiment17$Kidneys <- experiment17$Kidneys *admin.dose*VKi*1000/100
experiment17$Heart <- experiment17$Heart *admin.dose*VH*1000/100
experiment17$Lungs <- experiment17$Lungs  *admin.dose*VLn*1000/100
experiment17$Stomach <- experiment17$Stomach*admin.dose*VSt*1000/100
experiment17$Intestine <- experiment17$Intestine*admin.dose*(VSIn+VLIn)*1000/100
experiment17$Brain <- experiment17$Brain*admin.dose*VBr*1000/100
# Convert Yang 2013, male nanographene sheets_tissues from long to wide format using reshape
experiment18 <- reshape(Yang_IP_tissues[c("Tissue" ,"Time_min",
"%ID/gtissue")],
idvar = "Time_min", timevar = "Tissue", direction = "wide")
colnames(experiment18) <- c("Time",unique(Yang_IP_tissues$Tissue))
experiment18$Liver <- experiment18$Liver *admin.dose*VLi*1000/100
experiment18$Spleen <- experiment18$Spleen*admin.dose*VSpl*1000/100
experiment18$Kidneys <- experiment18$Kidneys *admin.dose*VKi*1000/100
experiment18$Heart <- experiment18$Heart *admin.dose*VH*1000/100
experiment18$Lungs <- experiment18$Lungs  *admin.dose*VLn*1000/100
experiment18$Stomach <- experiment18$Stomach*admin.dose*VSt*1000/100
experiment18$Intestine <- experiment18$Intestine*admin.dose*(VSIn+VLIn)*1000/100
experiment18$Brain <- experiment18$Brain*admin.dose*VBr*1000/100
# Convert Yang 2013, male nanographene sheets_tissues from long to wide format using reshape
experiment19 <- reshape(Yang_OR_tissues[c("Tissue" ,"Time_min",
"%ID/gtissue")],
idvar = "Time_min", timevar = "Tissue", direction = "wide")
colnames(experiment19) <- c("Time",unique(Yang_OR_tissues$Tissue))
experiment19$Liver <- experiment19$Liver *admin.dose*VLi*1000/100
experiment19$Spleen <- experiment19$Spleen*admin.dose*VSpl*1000/100
experiment19$Kidneys <- experiment19$Kidneys *admin.dose*VKi*1000/100
experiment19$Heart <- experiment19$Heart *admin.dose*VH*1000/100
experiment19$Lungs <- experiment19$Lungs  *admin.dose*VLn*1000/100
experiment19$Stomach <- experiment19$Stomach*admin.dose*VSt*1000/100
experiment19$Intestine <- experiment19$Intestine*admin.dose*(VSIn+VLIn)*1000/100
experiment19$Brain <- experiment19$Brain*admin.dose*VBr*1000/100
# Convert Yang 2013, male RGO sheets_tissues from long to wide format using reshape
experiment20 <- reshape(Yang_IP_tissues_RGO[c("Tissue" ,"Time_min",
"%ID/gtissue")],
idvar = "Time_min", timevar = "Tissue", direction = "wide")
colnames(experiment20) <- c("Time",unique(Yang_IP_tissues_RGO$Tissue))
experiment20$Liver <- experiment20$Liver *admin.dose*VLi*1000/100
experiment20$Spleen <- experiment20$Spleen*admin.dose*VSpl*1000/100
experiment20$Kidneys <- experiment20$Kidneys *admin.dose*VKi*1000/100
experiment20$Heart <- experiment20$Heart *admin.dose*VH*1000/100
experiment20$Lungs <- experiment20$Lungs  *admin.dose*VLn*1000/100
experiment20$Stomach <- experiment20$Stomach*admin.dose*VSt*1000/100
experiment20$Intestine <- experiment20$Intestine*admin.dose*(VSIn+VLIn)*1000/100
experiment20$Brain <- experiment20$Brain*admin.dose*VBr*1000/100
# Convert Yang 2013, male RGO sheets_tissues from long to wide format using reshape
experiment21 <- reshape(Yang_OR_tissues_RGO[c("Tissue" ,"Time_min",
"%ID/gtissue")],
idvar = "Time_min", timevar = "Tissue", direction = "wide")
colnames(experiment21) <- c("Time",unique(Yang_OR_tissues_RGO$Tissue))
experiment21$Liver <- experiment21$Liver *admin.dose*VLi*1000/100
experiment21$Spleen <- experiment21$Spleen*admin.dose*VSpl*1000/100
experiment21$Kidneys <- experiment21$Kidneys *admin.dose*VKi*1000/100
experiment21$Heart <- experiment21$Heart *admin.dose*VH*1000/100
experiment21$Lungs <- experiment21$Lungs  *admin.dose*VLn*1000/100
experiment21$Stomach <- experiment21$Stomach*admin.dose*VSt*1000/100
experiment21$Intestine <- experiment21$Intestine*admin.dose*(VSIn+VLIn)*1000/100
experiment21$Brain <- experiment21$Brain*admin.dose*VBr*1000/100
# Convert Yang 2013, male nanoRGO sheets_tissues from long to wide format using reshape
experiment22 <- reshape(Yang_IP_tissues_nRGO[c("Tissue" ,"Time_min",
"%ID/gtissue")],
idvar = "Time_min", timevar = "Tissue", direction = "wide")
colnames(experiment22) <- c("Time",unique(Yang_IP_tissues_nRGO$Tissue))
experiment22$Liver <- experiment22$Liver *admin.dose*VLi*1000/100
experiment22$Spleen <- experiment22$Spleen*admin.dose*VSpl*1000/100
experiment22$Kidneys <- experiment22$Kidneys *admin.dose*VKi*1000/100
experiment22$Heart <- experiment22$Heart *admin.dose*VH*1000/100
experiment22$Lungs <- experiment22$Lungs  *admin.dose*VLn*1000/100
experiment22$Stomach <- experiment22$Stomach*admin.dose*VSt*1000/100
experiment22$Intestine <- experiment22$Intestine*admin.dose*(VSIn+VLIn)*1000/100
experiment22$Brain <- experiment22$Brain*admin.dose*VBr*1000/100
# Convert Yang 2013, male nanoRGO sheets_tissues from long to wide format using reshape
experiment23 <- reshape(Yang_OR_tissues_nRGO[c("Tissue" ,"Time_min",
"%ID/gtissue")],
idvar = "Time_min", timevar = "Tissue", direction = "wide")
colnames(experiment23) <- c("Time",unique(Yang_OR_tissues_nRGO$Tissue))
experiment23$Liver <- experiment23$Liver *admin.dose*VLi*1000/100
experiment23$Spleen <- experiment23$Spleen*admin.dose*VSpl*1000/100
experiment23$Kidneys <- experiment23$Kidneys *admin.dose*VKi*1000/100
experiment23$Heart <- experiment23$Heart *admin.dose*VH*1000/100
experiment23$Lungs <- experiment23$Lungs  *admin.dose*VLn*1000/100
experiment23$Stomach <- experiment23$Stomach*admin.dose*VSt*1000/100
experiment23$Intestine <- experiment23$Intestine*admin.dose*(VSIn+VLIn)*1000/100
experiment23$Brain <- experiment23$Brain*admin.dose*VBr*1000/100
# Put the experiments in a list
experiments <- list(experiment1 = experiment1, experiment2 = experiment2, experiment3 = experiment3,
experiment4 = experiment4, experiment5 = experiment5, experiment6 = experiment6,
experiment7 = experiment7, experiment8 = experiment8, experiment9=experiment9,
experiment10 = experiment10, experiment11 = experiment11,experiment12 = experiment12,
experiment13 = experiment13, experiment14 = experiment14,experiment15 = experiment15,
experiment16 = experiment16, experiment17 = experiment17, experiment18 = experiment18,
experiment19 = experiment19, experiment20 = experiment20, experiment21 = experiment21,
experiment22 = experiment22, experiment23 = experiment23)
# Rename predictions so that they share the same name as the names of the experimental data dataframe
colnames(preds_Liu_1_small_tissues) <- c("Time", "Heart", "Liver","Spleen", "Stomach",
"Kidneys", "Lungs", "Brain","Small_intestine", "Large_intestine")
colnames(preds_Liu_1_small_diftp_tissues) <- c("Time", "Heart", "Liver","Spleen", "Stomach",
"Kidneys", "Lungs", "Brain","Small_intestine", "Large_intestine")
colnames(preds_Liu_1_large_diftp_tissues) <- c("Time", "Heart", "Liver","Spleen", "Stomach",
"Kidneys", "Lungs", "Brain","Small_intestine", "Large_intestine")
colnames(preds_Liu_2_small_tissues) <- c("Time", "Heart", "Liver","Spleen", "Stomach",
"Kidneys", "Lungs", "Brain","Small_intestine", "Large_intestine")
colnames(preds_Liu_10_small_tissues) <- c("Time", "Heart", "Liver","Spleen", "Stomach",
"Kidneys", "Lungs", "Brain","Small_intestine", "Large_intestine")
colnames(preds_Liu_1_small_diftp_blood) <- c("Time", "Blood")
colnames(preds_Liu_1_large_diftp_blood) <- c("Time", "Blood")
colnames(preds_Li_IN_tissues) <- c("Time", "Blood", "Heart", "Lungs","Liver", "Spleen", "Kidney",
"Stomach","Small_intestine", "Large_intestine")
colnames(preds_Li_IV_tissues) <- c("Time", "Blood", "Heart", "Lungs","Liver", "Spleen", "Kidney",
"Stomach","Small_intestine", "Large_intestine")
colnames(preds_Li_IV_blood) <- c("Time", "Blood")
colnames(preds_Li_IV_tissues_PEG) <- c("Time", "Lungs","Liver", "Spleen")
colnames(preds_Li_IV_blood_PEG) <- c("Time", "Blood")
colnames(preds_Mao_IN_tissues) <- c("Time", "Liver", "Spleen", "Stomach","Small_intestine",
"Large_intestine","Lungs", "Feces")
colnames(preds_Mao_OR_tissues) <- c("Time", "Stomach","Small_intestine",
"Large_intestine","Feces")
colnames(preds_Yang_IV_blood) <- c("Time", "Blood")
colnames(preds_Yang_IV_LiSpl) <- c("Time", "Liver", "Spleen")
colnames(preds_Yang_IV_tissues) <- c("Time", "Liver","Spleen", "Kidneys", "Heart","Lungs",
"Stomach","Intestine","Brain")
colnames(preds_Yang_IP_tissues) <- c("Time", "Liver","Spleen", "Kidneys", "Heart","Lungs",
"Stomach","Intestine","Brain")
colnames(preds_Yang_OR_tissues) <- c("Time", "Liver","Spleen", "Kidneys", "Heart","Lungs",
"Stomach","Intestine","Brain")
colnames(preds_Yang_IP_tissues_RGO) <- c("Time", "Liver","Spleen", "Kidneys", "Heart","Lungs",
"Stomach","Intestine","Brain")
colnames(preds_Yang_OR_tissues_RGO) <- c("Time", "Liver","Spleen", "Kidneys", "Heart","Lungs",
"Stomach","Intestine","Brain")
colnames(preds_Yang_IP_tissues_nRGO) <- c("Time", "Liver","Spleen", "Kidneys", "Heart","Lungs",
"Stomach","Intestine","Brain")
colnames(preds_Yang_OR_tissues_nRGO) <- c("Time", "Liver","Spleen", "Kidneys", "Heart","Lungs",
"Stomach","Intestine","Brain")
# Create a list containing the corresponding predictions
simulations <- list(predictions1 = preds_Liu_1_small_tissues, predictions2 = preds_Liu_1_small_diftp_tissues,
predictions3 = preds_Liu_1_large_diftp_tissues, predictions4 = preds_Liu_2_small_tissues,
predictions5 = preds_Liu_10_small_tissues, predictions6 = preds_Liu_1_small_diftp_blood,
predictions7 = preds_Liu_1_large_diftp_blood, predictions8 = preds_Li_IN_tissues,
predictions9 = preds_Li_IV_tissues, predictions10 = preds_Li_IV_blood,
predictions11 = preds_Li_IV_tissues_PEG, predictions12 = preds_Li_IV_blood_PEG,
predictions13 = preds_Mao_IN_tissues, predictions14 = preds_Mao_OR_tissues,
predictions15 = preds_Yang_IV_blood, predictions16 = preds_Yang_IV_LiSpl,
predictions17 = preds_Yang_IV_tissues, predictions18 = preds_Yang_IP_tissues,
predictions19 = preds_Yang_OR_tissues, predictions20 = preds_Yang_IP_tissues_RGO,
predictions21 = preds_Yang_OR_tissues_RGO, predictions22 = preds_Yang_IP_tissues_nRGO,
predictions23 = preds_Yang_OR_tissues_nRGO)
# Iterate over all existing experiments and create the accompanying plots
for(i in 1:length(experiments)){
# Retrieve the corresponding observations and simulations
observations <- experiments[[i]]
predictions <- simulations[[i]]
# Extract the compartment names
compartments <- names(predictions)[2:length(predictions)]
# Use lapply to iterate over the column names and create plots
plots <- lapply(compartments, function(compartment) {
create.plots(predictions, observations, compartment )
})
if(length(compartments) == 1){
final_plot <- do.call(ggpubr::ggarrange, c(plots, ncol = 1, nrow = 1,
common.legend = TRUE, legend = "right"))
}else{
final_plot <- do.call(ggpubr::ggarrange, c(plots, ncol = 3, nrow = ceiling(length(plots) / 3),
common.legend = TRUE, legend = "right"))
}
plot.margin=unit(c(0,0,0,0), "pt")
# Save the plot with dynamically adjusted dimensions
ggsave(paste0("experiment", i,".png"), plot = final_plot,
device = 'png', dpi = 300,
width = 13,
height = 10,
units = "in")
}
